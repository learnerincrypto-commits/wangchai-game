<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>æ—ºæŸ´äº’åŠ¨å°æ¸¸æˆ Wangchai Interactive Game</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
      background: #e0f7fa;
      font-family: Arial, sans-serif;
    }
    .avatar {
      position: relative;
      width: 300px;
    }
    .avatar img {
      width: 100%;
      display: block;
    }
    .hotspot {
      position: absolute;
      cursor: pointer;
      background: rgba(255, 0, 0, 0);
    }
    #score, #timer {
      font-size: 22px;
      font-weight: bold;
      margin: 5px;
      color: #00796b;
    }
    #reaction {
      margin-top: 10px;
      font-size: 18px;
      color: #333;
      text-align: center;
    }
    /* è§†é¢‘èœå• */
    #videoMenu {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.3);
      text-align: center;
      z-index: 1000;
    }
    #videoMenu h2 { margin-bottom: 15px; }
    #videoMenu button {
      display: block;
      margin: 8px auto;
      padding: 8px 15px;
      border: none;
      background: #00796b;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    #videoMenu button:hover { background: #004d40; }
    #videoPlayer {
      margin-top: 10px;
      width: 300px;
      display: none;
    }
    /* éŸ³ä¹æŒ‰é’® */
    #musicControl {
      margin-top: 15px;
      padding: 8px 15px;
      background: #ff9800;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: white;
      font-size: 16px;
    }
    #musicControl:hover { background: #e68900; }
  </style>
</head>
<body>
  <h1>æ—ºæŸ´äº’åŠ¨å°æ¸¸æˆ<br>Wangchai Interactive Game</h1>
  <div id="score">åˆ†æ•°/Scoreï¼š0</div>
  <div id="timer">å‰©ä½™æ—¶é—´/Time Leftï¼š30 ç§’/sec</div>

  <div class="avatar">
    <img id="dog" src="wangchai 1.png" alt="ç‹—å¤´ Dog Head">
    <!-- ç‚¹å‡»åŒºåŸŸ -->
    <div class="hotspot" style="left:80px; top:100px; width:50px; height:40px;" onclick="react(true, 'çœ¼ç›/Eyes', 10)"></div>
    <div class="hotspot" style="left:120px; top:170px; width:60px; height:40px;" onclick="react(true, 'å˜´å·´/Mouth', 20)"></div>
    <div class="hotspot" style="left:200px; top:50px; width:60px; height:60px;" onclick="react(false, 'è€³æœµ/Ears', -10)"></div>
  </div>

  <div id="reaction">ğŸ‘† ç‚¹å‡»æ—ºæŸ´çœ‹çœ‹ååº”ï¼<br>ğŸ‘† Tap Wangchai to see reaction!</div>
  <button id="musicControl" onclick="toggleMusic()">æš‚åœéŸ³ä¹ / Pause Music</button>

  <!-- èƒŒæ™¯éŸ³ä¹ -->
  <audio id="bgm" src="bgm.mp3" autoplay loop></audio>

  <!-- è§†é¢‘èœå• -->
  <div id="videoMenu">
    <h2>ğŸ¬ èœå• / Video Menu</h2>
    <div id="videoOptions"></div>
    <video id="videoPlayer" controls></video>
  </div>

  <script>
    let score = 0;
    let timeLeft = 30;
    let countdown;
    let hotspotMove;
    let phase = 1; // å½“å‰é˜¶æ®µ / Current phase

    const faces = [
      "wangchai 1.png","wangchai 2.png","wangchai 3.png",
      "wangchai 4.png","wangchai 5.png","wangchai 6.png",
      "wangchai 7.png","wangchai 8.png","wangchai 9.png","wangchai 10.png",
      "wangchai 11.png","wangchai 12.png","wangchai 13.png","wangchai 14.png","wangchai 15.png",
      "wangchai 16.png","wangchai 17.png","wangchai 18.png","wangchai 19.png","wangchai 20.png"
    ];

    const bgm = document.getElementById("bgm");
    const musicBtn = document.getElementById("musicControl");

    function startTimer() {
      clearInterval(countdown);
      countdown = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").innerText = "å‰©ä½™æ—¶é—´/Time Leftï¼š" + timeLeft + " ç§’/sec";
        if (timeLeft <= 0) {
          clearInterval(countdown);
          alert("æ—¶é—´åˆ°ï¼æ¸¸æˆç»“æŸï¼\nTimeâ€™s up! Game Over!");
        }
      }, 1000);
    }

    function setPhase(newPhase) {
      phase = newPhase;
      clearInterval(hotspotMove);
      if (phase === 1) {
        if (timeLeft < 30) timeLeft = 30;
      } else if (phase === 2) {
        if (timeLeft < 25) timeLeft = 25;
        hotspotMove = setInterval(moveHotspots, 5000);
      } else if (phase === 3) {
        if (timeLeft < 20) timeLeft = 20;
        hotspotMove = setInterval(moveHotspots, 5000);
      }
      document.getElementById("timer").innerText = "å‰©ä½™æ—¶é—´/Time Leftï¼š" + timeLeft + " ç§’/sec";
      startTimer();
    }

    function react(correct, part, points) {
      const randomFace = faces[Math.floor(Math.random() * faces.length)];
      document.getElementById("dog").src = randomFace;

      if (correct) {
        score += points;
        timeLeft += 2;
      } else {
        score += points;
        timeLeft -= 3;
      }
      if (score < 0) score = 0;
      document.getElementById("score").innerText = "åˆ†æ•°/Scoreï¼š" + score;

      document.getElementById("reaction").innerHTML =
        (correct ? "âœ… æ­£ç¡® / Correct" : "âŒ é”™è¯¯ / Wrong") +
        " - ä½ ç‚¹äº† " + part +
        " (ç§¯åˆ†/Points " + (points > 0 ? "+" : "") + points + ")";

      if (score >= 100 && phase === 1) {
        openMenu("ğŸ‰ ä½ åˆ°è¾¾ 100 åˆ†ï¼é€‰æ‹©ä¸€ä¸ªè§†é¢‘ï¼š<br>ğŸ‰ You reached 100 points! Choose a video:", [
          {name:"å¼€å¿ƒ / Happy", file:"happy.mp4"},
          {name:"æç¬‘ / Funny", file:"funny.mp4"},
          {name:"ç¥ç§˜ / Mystery", file:"mystery.mp4"}
        ]);
        setPhase(2);
      } else if (score >= 200 && phase === 2) {
        openMenu("ğŸ‰ ä½ åˆ°è¾¾ 200 åˆ†ï¼ç¥ç§˜èœå•ï¼š<br>ğŸ‰ You reached 200 points! Mystery video:", [
          {name:"ç¥ç§˜ / Secret", file:"secret.mp4"}
        ]);
        setPhase(3);
      } else if (score >= 300) {
        openMenu("ğŸ† 300 åˆ†æ»¡åˆ†ï¼ç»ˆæå½©è›‹ï¼<br>ğŸ† 300 points! Final Easter Egg!", [
          {name:"ç»ˆæå½©è›‹ / Ultimate Egg", file:"ultimate.mp4"}
        ]);
        clearInterval(countdown);
      }
    }

    function moveHotspots() {
      document.querySelectorAll(".hotspot").forEach(hs => {
        hs.style.left = Math.random() * 200 + "px";
        hs.style.top = Math.random() * 150 + "px";
      });
    }

    function openMenu(title, options) {
      clearInterval(countdown);
      bgm.pause(); // æš‚åœèƒŒæ™¯éŸ³ä¹ / Pause music
      document.getElementById("videoMenu").style.display = "block";
      document.querySelector("#videoMenu h2").innerHTML = title;
      const optionsDiv = document.getElementById("videoOptions");
      optionsDiv.innerHTML = "";
      options.forEach(opt => {
        const btn = document.createElement("button");
        btn.innerText = opt.name;
        btn.onclick = () => playVideo(opt.file);
        optionsDiv.appendChild(btn);
      });
    }

    function playVideo(file) {
      const player = document.getElementById("videoPlayer");
      player.src = file;
      player.style.display = "block";
      player.play();
      document.getElementById("videoOptions").innerHTML = "ğŸ¬ æ­£åœ¨æ’­æ”¾... / Now Playing...";
      player.onended = () => closeMenu();
    }

    function closeMenu() {
      document.getElementById("videoMenu").style.display = "none";
      const player = document.getElementById("videoPlayer");
      player.pause();
      player.style.display = "none";
      bgm.play(); // ç»§ç»­æ’­æ”¾éŸ³ä¹ / Resume music
      startTimer();
    }

    function toggleMusic() {
      if (bgm.paused) {
        bgm.play();
        musicBtn.innerText = "æš‚åœéŸ³ä¹ / Pause Music";
      } else {
        bgm.pause();
        musicBtn.innerText = "æ’­æ”¾éŸ³ä¹ / Play Music";
      }
    }

    setPhase(1);
  </script>
</body>
</html>
